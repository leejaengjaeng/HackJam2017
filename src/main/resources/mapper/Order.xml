<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
		PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.hackjam.dao.OrderDAO">
	<select id="select" resultType="Order" parameterType="int">
		SELECT
			order_id,
			employee_no,
			(SELECT SUM(cost) FROM order_detail where order_id = o.order_id) AS cost,
			order_ymdt,
			finish_ymdt,
			order_status
		FROM
			`order` o
		WHERE
			order_id = #{orderId}
	</select>

	<select id="selectAll" resultType="Order">
		SELECT
			order_id,
			employee_no,
			(SELECT SUM(cost) FROM order_detail where order_id = o.order_id) AS cost,
			order_ymdt,
			finish_ymdt,
			order_status
		FROM
			`order` o
	</select>

	<insert id="insert" parameterType="Order" useGeneratedKeys="true" keyProperty="orderId">
		INSERT
		INTO
			`order` (
			employee_no,
			order_ymdt,
			order_status
		)
		VALUES (
			#{employeeNo},
			NOW(),
			#{orderStatus}
		)
	</insert>
</mapper>